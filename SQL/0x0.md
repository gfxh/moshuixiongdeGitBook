# 这里是SQL的世界
## 0x0 简介
SQL注入是Web安全主要威胁之一，因输入验证缺失导致攻击者可伪造恶意SQL命令。本文介绍注入原理、常用函数、检测方法及union注入、盲注（布尔、时间、报错）等技术

注入攻击漏洞往往是应用程序缺少对输入进行安全性检查所引起的。攻击者把一些包含攻击代码当做命令或者查询语句发送给解释器，这些恶意数据可以欺骗解释器，从而执行计划外的命令或者未授权访问数据。注入漏洞通常能sql查询，ldap查询，os命令，程序参数等中出现。
##### SQL注入常用函数
```
version()                       #数据库版本
database()                      #当前数据库名
user()                          #用户名
current_user()                  #当前用户名
system_user()                   #系统用户名
@@datadir                       #数据库路径
@@version_compile_os            #操作系统版本
#                               字符串函数
length()                        # 返回字符串长度
mid() left() right() substr()   # 截取字符串
concat()                        # 没有分隔符连接字符串
concat_ws()                     # 含有分隔符连接字符串
group_concat()                  # 连接一个组的字符串
ord()                           # 返回ASCII码
ascii()                         # 字符转ascii码
md5()                           #返回md5值
floor(x)                        # 不大于x的最大整数
round(x)                        # 返回参数x接近的整数
rand(x)                         # 0-1之间的随机浮点数
sleep()                         #睡眠时间
if(true,t,f)                    # IF判断语句

# 重要的数据库

information_schema              # 包含mysql中所有数据库信息

# 重要的表

schemate                        # mysql中所有数据库的信息
  schema_name                   #所有的数据库名
tables                          # 数据库表中的信息
  table_name                    #记录数据表名
columns                         #列信息
  column_name                   #字段名
```


## 0x1 分辨数字和字符
在SQL注入和SQL语句中，数据类型不同 书写方式也不同
1. 数据类型的数据，传入参数时可直接用数字

    `select * from users where id=1`  在users表中查询id=1的所有字段

1. 字符串类型 必须使用   "  或  '  （闭合）

    `select * from users where username = '小明' ` 在users表中查询username为 小明 的所有字段
## 0x2 SQL注入判断方法论
SQL注入的判断过程称之为FUZZ

简单来说就是 "不停的猜，直到猜对为止"

第一步：辨别数据类型为 数字还是字符串

第二步：闭合+注释

`select *from users where username=' 小明’ '` 

(前面的  ’  正好把username = ' ' 给闭合了，但后面还有一个  '  数据库会认为字符串还没有正确结束，sql语法检查无法通过 )

第三步：判断是否注入成功
```
1 使用单引号判断是 字符型 还是  数字型
闭合+注解

方式选择
2  有显示位：union(联合注入)

3  无显示位：但是网页会根据代码而改变： 布尔盲注
4  无显示位，网页也不会变化，具体看网站的回显时间：时间盲注
```






# 实例
```
use `security`;

# 查询mysql 中的所有数据库
# 结果 ：information_schema,challenges,dvwa,mysql,performance_schema,security,test
select GROUP_CONCAT(SCHEMA_NAME ) from information_schema.SCHEMATA ;

# 查询 security数据库中的所有表
# 结果：emails,referers,uagents,users
select group_concat(table_name) from information_schema.TABLES where TABLE_SCHEMA = database();

# 查询security数据库中users表的的字段信息
# 结果：id,username,password
select GROUP_CONCAT(column_name) from information_schema.COLUMNS where TABLE_SCHEMA= database() and table_name='users';

```












































